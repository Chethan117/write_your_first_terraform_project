import os
import shutil

main_folder = r"path/to/main_folder"

# Define the file extensions and document names to keep
sas_extensions = [".sas"]
doc_names = ["handover doc", "data development doc"]

# Function to delete a file or folder with force removal
def force_remove(path):
    try:
        if os.path.isfile(path):
            os.remove(path)
        else:
            shutil.rmtree(path, ignore_errors=True)
    except (OSError, PermissionError):
        pass

# Recursive function to traverse the directory structure
def traverse_directory(folder_path):
    for item in os.listdir(folder_path):
        item_path = os.path.join(folder_path, item)
        if os.path.isdir(item_path):
            traverse_directory(item_path)
        else:
            file_name, file_extension = os.path.splitext(item)
            if file_extension.lower() in sas_extensions or any(doc_name.lower() in file_name.lower() for doc_name in doc_names):
                continue
            force_remove(item_path)

# Start the directory traversal
traverse_directory(main_folder)
